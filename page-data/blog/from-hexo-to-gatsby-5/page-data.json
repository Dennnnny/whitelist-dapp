{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-path-js","path":"/blog/from-hexo-to-gatsby-5/","result":{"data":{"markdownRemark":{"html":"<p>ä»Šå¤©è¦ä¾†åˆ†äº«å¦ä¸€å€‹ç•™è¨€çš„æ–¹å¼ï½</p>\n<p><a href=\"/blog/from-hexo-to-gatsby-4\">ä¸Šä¸€ç¯‡</a>æœ‰åˆ†äº«åˆ°<br>\næˆ‘æœ‰åšäº†ä¸€å€‹å¯ä»¥é€£çµ google-sheet çš„ç•™è¨€æ–¹å¼<br>\né‚£éº¼ä»Šå¤© è¦ä¾†åˆ†äº«ä¸€å€‹ gatsby çš„æ’ä»¶<br>\nå«åš Utterances<br>\n<a href=\"https://www.gatsbyjs.com/docs/how-to/adding-common-features/adding-comments/\">é€™è£¡</a>æ˜¯å®˜æ–¹æœ‰æ¨è–¦çš„å¹¾ç¨®æ–¹å¼<br>\nå…¶ä¸­æœ‰äº›æœƒæ˜¯ç¬¬ä¸‰æ–¹çš„æœå‹™ æ‰€ä»¥ç•™è¨€å…§å®¹å¯èƒ½ä¹Ÿæœƒå­˜åœ¨ç¬¬ä¸‰æ–¹çš„è³‡æ–™åº«<br>\né‚£å› ç‚ºæˆ‘æ˜¯ç›´æ¥æ¶åœ¨ girhub ä¸Š<br>\ngitalk è·Ÿ Utterances éƒ½æ˜¯ç›´æ¥å­˜é€² github çš„ issue è£¡é¢<br>\næˆ‘é€™é‚Šé¸æ“‡äº† Utterances</p>\n<p>æ­¥é©Ÿä¹Ÿæ˜¯æ»¿ç°¡å–®çš„</p>\n<p>é¦–å…ˆï¼š è¦æˆæ¬Šçµ¦é€™å€‹<a href=\"https://github.com/apps/utterances\">å¥—ä»¶</a><br>\næ¥è‘—ï¼š é–‹ä¸€å€‹ repo ä¾†æ”¾ç•™è¨€ ex: comments-repo<br>\nç„¶å¾Œï¼š å¯ä»¥åœ¨é€™å€‹<a href=\"https://utteranc.es/\">ç¶²é </a>è£¡ç”¢å‡ºè¨­å®šæª”<br>\n=> å¡«å…¥ username/repo-name<br>\n=> é¸æ“‡æ–‡ç« èˆ‡ç•™è¨€å€çš„ mapping æ–¹å¼<br>\n=> é¸æ“‡ä¸»é¡Œ<br>\næœ€ä¸‹æ–¹æœƒç”¢ç”Ÿä¸€å€‹è¨­å®šæª”<br>\né€™å°±æ˜¯è¦æ”¾é€² script è£¡é¢çš„è¨­å®š å°±æœƒè‡ªå‹•ç”¢ç”Ÿä¸€å€‹ç•™è¨€å€äº†ï½ï½</p>\n<p>ç¾åœ¨ä¾†å‰µä¸€å€‹å…ƒä»¶ï¼š Comments.js ç”¨ä¾†è¼‰å…¥é€™å€‹ script</p>\n<pre class=\"grvsc-container abyss\" data-language=\"js\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">export</span><span class=\"mtk1\"> </span><span class=\"mtk7\">default</span><span class=\"mtk1\"> </span><span class=\"mtk15 mtki\">function</span><span class=\"mtk1\"> </span><span class=\"mtk6\">Comments</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> commentsRef </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> React.</span><span class=\"mtk6\">useRef</span><span class=\"mtk1\">(</span><span class=\"mtk4\">null</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> theme </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">useTheme</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> githubTheme </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> theme?.type </span><span class=\"mtk7\">||</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&quot;dark&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  React.</span><span class=\"mtk6\">useEffect</span><span class=\"mtk1\">(() </span><span class=\"mtk15 mtki\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> script </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> document.</span><span class=\"mtk6\">createElement</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;script&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    script.src </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&quot;https://utteranc.es/client.js&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    script.</span><span class=\"mtk6\">setAttribute</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;repo&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk11\">&quot;Dennnnny/dennnnny.github.io.comments&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    script.</span><span class=\"mtk6\">setAttribute</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;issue-term&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk11\">&quot;pathname&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    script.</span><span class=\"mtk6\">setAttribute</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;label&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk11\">&quot;âœ¨ğŸ’¬âœ¨&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    script.</span><span class=\"mtk6\">setAttribute</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;theme&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk11\">`github-${</span><span class=\"mtk1\">githubTheme</span><span class=\"mtk11\">}`</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    script.</span><span class=\"mtk6\">setAttribute</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;crossorigin&quot;</span><span class=\"mtk1\">, </span><span class=\"mtk11\">&quot;anonymous&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    script.async </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk4\">true</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> COMMENT_REF </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> commentsRef.current;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> (COMMENT_REF) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      COMMENT_REF.</span><span class=\"mtk6\">appendChild</span><span class=\"mtk1\">(script);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">return</span><span class=\"mtk1\"> () </span><span class=\"mtk15 mtki\">=&gt;</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> (COMMENT_REF) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        COMMENT_REF.innerHTML </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk11\">&quot;&quot;</span><span class=\"mtk1\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  }, [githubTheme]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">return</span><span class=\"mtk1\"> &lt;</span><span class=\"mtk7\">div</span><span class=\"mtk1\"> </span><span class=\"mtk6\">ref</span><span class=\"mtk7\">=</span><span class=\"mtk1\">{commentsRef} /&gt;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>ç”¨ useEffect ä¾†è¨­å®š script<br>\nå› ç‚ºæˆ‘æœ‰ç”¨æš—é»‘æ¨¡å¼ æ‰€ä»¥è¦åœ¨åˆ‡æ›æ¨¡å¼çš„æ™‚å€™ é‡æ–°è¼‰å…¥ä¸€æ¬¡ ç•™è¨€å€çš„æ¨¡å¼è¨­å®š<br>\nå¦‚æœä½ æ²’æœ‰çš„è©± å¯ä»¥ç›´æ¥æŠŠä¸»é¡Œå¯«é€² script ä¸ç”¨å‹•æ…‹çš„<br>\né€™æ¨£å°±ç®—æ˜¯ å®Œæˆäº†ç•™è¨€å…ƒä»¶</p>\n<p>åªè¦æŠŠå®ƒæ”¾åˆ°æ–‡ç« è£¡é¢å°±å¯ä»¥çœ‹åˆ°ä»–å‡ºç¾åœ¨æ–‡ç« çš„ä¸‹æ–¹äº†ï½ï½\nç®—æ˜¯æ»¿ç°¡å–®çš„åŠŸèƒ½<br>\nä½†æ˜¯éå¸¸å¯¦ç”¨ ï¼¸ï¼¤</p>\n<p>å¤§è‡´ä¸Šæˆ‘é–‹ç™¼çš„åŠŸèƒ½ç²—ç•¥çš„å°±ä»‹ç´¹åˆ°é€™æ¨£<br>\nå¦‚æœæœ‰äººåœ¨çœ‹(?) ç„¶å¾Œå°æ–¼æŸå€‹ä¸»é¡Œ/åŠŸèƒ½ç‰¹åˆ¥æœ‰èˆˆè¶£çš„è©±<br>\næ­¡è¿ç•™è¨€ï¼¸ï¼¤</p>\n<p>æ¥ä¸‹ä¾†æ‡‰è©²é‚„æœƒæ˜¯ä¸€å…©ç¯‡çš„ Gatsby åˆ†äº«<br>\nå…§å®¹é è¨ˆæ˜¯<br>\n(1) éƒ¨ç½²åˆ° github-pages ä¸Š<br>\n(2) è·Ÿ gatsby ä¸å¤ªæœ‰é—œçš„æ–¹ä¾¿çš„ç”¢å…ƒä»¶å·¥å…·<br>\nä»¥åŠä¹‹å¾Œå¦‚æœæœ‰å®Œæˆ æœƒå†åˆ†äº«çš„ä¸€äº›åŠŸèƒ½çš„é–‹ç™¼</p>\n<p>ä»¥ä¸Šæ˜¯ä»Šå¤©çš„åˆ†äº« ğŸ‘‹</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .abyss { background-color: #000c18; }\n  .abyss .mtki { font-style: italic; }\n  .abyss .mtk7 { color: #225588; }\n  .abyss .mtk1 { color: #6688CC; }\n  .abyss .mtk15 { color: #9966B8; }\n  .abyss .mtk6 { color: #DDBB88; }\n  .abyss .mtk4 { color: #F280D0; }\n  .abyss .mtk11 { color: #22AA44; }\n  .abyss .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"September 18, 2022","path":"/blog/from-hexo-to-gatsby-5","title":"Gatsbyç”¨èµ·ä¾†_ç•™è¨€ Utterances","type":"blog","image_cover":"https://images.unsplash.com/photo-1616628188859-7a11abb6fcc9?fit=crop&w=1000&q=80"}}},"pageContext":{"id":"cc34ddc0-8103-54ed-9743-d6774c76464e","frontmatter__path":"/blog/from-hexo-to-gatsby-5","__params":{"frontmatter__path":"blog"}}},"staticQueryHashes":["3764592887"]}