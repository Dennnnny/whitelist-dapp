{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-path-js","path":"/blog/from-hexo-to-gatsby-4/","result":{"data":{"markdownRemark":{"html":"<h1>Gatsby æ­é… google sheet</h1>\n<p>ä»Šå¤©æ˜¯è¦åˆ†äº«ä¸€å€‹å°åŠŸèƒ½<br>\nå°±æ˜¯å³ä¸Šè§’çš„ Contact<br>\né»æ“Š contact ä¹‹å¾Œ æœƒè·³å‡ºä¸€å€‹å½ˆçª—<br>\nå¯ä»¥ç•™ä¸‹ä½ æƒ³è¦èªªçš„è©±ï½<br>\næˆ‘å¾ˆå–œæ­¡é€™å€‹åŠŸèƒ½ï¼¸ï¼¤</p>\n<p>é¦–å…ˆï½<br>\nè¦å…ˆæº–å‚™ä¸€å€‹ google è¡¨å–®<br>\næˆ‘å€‘è¦ä¾†æŠŠè¡¨å–®ç•¶æˆæ˜¯è³‡æ–™åº«ä¾†ä½¿ç”¨<br>\nå°±ä¾†åˆ†äº«ä¸€ä¸‹ å¦‚ä½•ä¸€æ­¥ä¸€æ­¥çš„æŠŠé€™å€‹è³‡æ–™åº«åšå‡ºä¾†</p>\n<p>ç¬¬ä¸€æ­¥ï¼š å»ºç«‹æ–°è©¦ç®—è¡¨</p>\n<p>æ¥è‘—è¦æº–å‚™è³‡æ–™åº«çš„ç¨‹å¼ç¢¼<br>\nç¬¬äºŒæ­¥ï¼š é–‹å•Ÿ app script<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/bff277f74e404b59d89289a4ec2ec734/c1bea/google_sheet.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.12883435582822%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABYlAAAWJQFJUiTwAAABQklEQVQoz22Q7WqEMBBFff/nKvRPoVDKlmWtW63ummz8ikaNRk9JlpYWOnAzyTBMztzoIXtC5CWn+MTHR8rxeCRJErIs43A4hKy15qYUXddhrWVZlpB/y9e8osfLM/IieU8S4jgmTTOu12vQ+XymLEukuvFyeuWYnRBSYgaDEIKqqqjrGmNGfOz7TsS607QtUt4YpynQTNMUaMZxou8HmqahbhryoqAoCja34Zz70bbd39YTznbGGEPf6yClKpZ1DfjObVi7MM8zXaf5/MzDev+FH+j7orc45T0T5FKTXlSg8T91uifPC/phCI1ClpzTlMu1RFU1g6cfzF3G/NyjvKxR2tKOIJqRxc7sEIZUlQpEzq3oYaZpO9q2DdSeaP2t1YV65Fe7O7r5g30neOINvhtNGNiZhVJIpJR//PuWXWxY+QuHnhiis08oPwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/bff277f74e404b59d89289a4ec2ec734/a6d36/google_sheet.png\"\n        srcset=\"/static/bff277f74e404b59d89289a4ec2ec734/222b7/google_sheet.png 163w,\n/static/bff277f74e404b59d89289a4ec2ec734/ff46a/google_sheet.png 325w,\n/static/bff277f74e404b59d89289a4ec2ec734/a6d36/google_sheet.png 650w,\n/static/bff277f74e404b59d89289a4ec2ec734/e548f/google_sheet.png 975w,\n/static/bff277f74e404b59d89289a4ec2ec734/3c492/google_sheet.png 1300w,\n/static/bff277f74e404b59d89289a4ec2ec734/c1bea/google_sheet.png 1388w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span>\n(åœ¨æ“´å……åŠŸèƒ½ä¸­ é»é¸)</p>\n<p>æ¥ä¸‹ä¾†å°±æœƒå…ˆçœ‹åˆ°é è¨­çš„ä¸€äº›ç¨‹å¼</p>\n<pre class=\"grvsc-container abyss\" data-language=\"js\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15 mtki\">function</span><span class=\"mtk1\"> </span><span class=\"mtk6\">myFunction</span><span class=\"mtk1\">() {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">//</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>é€™é‚Šå°±æ˜¯è¦ä¾†ç¨å¾®æ“ä½œä¸€ç•ªçš„åœ°æ–¹äº†<br>\nä¹‹å¾Œ æˆ‘å¯èƒ½æœƒ å»ç†è§£ä¸€ä¸‹ é€™æ•´å€‹ google sheet çš„ç”Ÿæ…‹ç³»\nè·Ÿä»–çš„ç´°ç¯€<br>\nä½†ç¾åœ¨ å°±å…ˆåˆ†äº«ä¸€ä¸‹ æˆ‘è‡ªå·±é€™é‚Šåšäº†ä»€éº¼</p>\n<pre class=\"grvsc-container abyss\" data-language=\"js\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// do post æ˜¯ä¹‹å¾Œç”¢ç”Ÿä¸€å€‹é€£çµç¶²å€  çµ¦ä½ æ‰“apiçš„æ™‚å€™</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">// é€™å€‹function æœƒåœ¨ä½ å°ç¶²å€ method:POST æ™‚åŸ·è¡Œçš„</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk15 mtki\">function</span><span class=\"mtk1\"> </span><span class=\"mtk6\">doPost</span><span class=\"mtk1\">(</span><span class=\"mtk19 mtki\">e</span><span class=\"mtk1\">) {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// æ‹¿åå­—å« messages çš„sheet(å·¥ä½œè¡¨)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> sheet </span><span class=\"mtk7\">=</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    SpreadsheetApp.</span><span class=\"mtk6\">getActiveSpreadsheet</span><span class=\"mtk1\">().</span><span class=\"mtk6\">getSheetByName</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;messages&quot;</span><span class=\"mtk1\">);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// æ‹¿åƒæ•¸</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// é€™é‚Šæˆ‘å‚³äº† user è·Ÿ message ç•¶åƒæ•¸</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> params </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk15\">JSON</span><span class=\"mtk1\">.</span><span class=\"mtk15\">parse</span><span class=\"mtk1\">(e.postData.contents);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> { user, message } </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> params;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> createTime </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">NOW</span><span class=\"mtk1\">();</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// åœ¨è¡¨å–®è£¡æ’å…¥ä¸€è¡Œè³‡æ–™</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// å…§å®¹æ˜¯ [createTime, user, message] åˆ†åˆ¥å„²å­˜åœ¨å‰ä¸‰æ¬„çš„å„²å­˜æ ¼è£¡</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  sheet.</span><span class=\"mtk6\">appendRow</span><span class=\"mtk1\">([createTime, user, message]);</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk15 mtki\">const</span><span class=\"mtk1\"> result </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    code: </span><span class=\"mtk4\">200</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    message: </span><span class=\"mtk11\">&quot;æˆåŠŸ&quot;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  };</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\">// æœ€å¾Œçµ¦api ä¸€å€‹response</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">return</span><span class=\"mtk1\"> ContentService.</span><span class=\"mtk6\">createTextOutput</span><span class=\"mtk1\">(</span><span class=\"mtk15\">JSON</span><span class=\"mtk1\">.</span><span class=\"mtk15\">stringify</span><span class=\"mtk1\">(result)).</span><span class=\"mtk6\">setMimeType</span><span class=\"mtk1\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    ContentService.MimeType.JSON</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  );</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>å¯«å®Œ function å¾Œå°±è¦æŠŠä»–éƒ¨ç½²èµ·ä¾†äº†<br>\nåœ¨å³ä¸Šæ–¹æœ‰é¡†éƒ¨ç½²æŒ‰éˆ•<br>\né¸æ“‡ æ–°å¢éƒ¨ç½²ä½œæ¥­<br>\næˆ‘çš„è¨­å®šæ˜¯é€™å€‹æ¨£å­çš„<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 650px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c8f5a4b38345fa0099dff321997e9efd/66632/deploy-app-script.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 65.6441717791411%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAABTUlEQVQ4y5VSi26DMAzk/39w60PttFGVR6BJykLeVzlAR1eYVksnW4lzsc/O6prh7X2D7W4PKSUmizG+DLIsz09grEEIAd57KNWDcw5r7UvE9FZIiawoS9SMJUK6cM6jbVv0vU6E4Z+E9N4Yg+xbKXRdl36YjH5SSqUk+sD5v0FvKY/yM8xs0sFal2QQQt6l8ORXMOWQTNmSsDSc87mAEAIhDPoMCLPYP50/VDgnvHCOw/E4Eq6RLGORkCZNApORNlMFdBbGFn+D2k1DWSKU8oqiKFFVNVjTJNAmsKYFDdE5l3S27hHrFfY9yqqCNua+EjEGxJXqhm1ww1CWCLU2EPKaqqCWf6oY1uMJSQ67Tsg7i/3XBR9nicOJY/fZ4JBfsM09NnlEySNqGVGJARSXIuLax0fCyTsfoI2HsQHaemgbxjgmWBdh/ehnsQ8RNwD8/FlwyNYRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"image\"\n        title=\"image\"\n        src=\"/static/c8f5a4b38345fa0099dff321997e9efd/a6d36/deploy-app-script.png\"\n        srcset=\"/static/c8f5a4b38345fa0099dff321997e9efd/222b7/deploy-app-script.png 163w,\n/static/c8f5a4b38345fa0099dff321997e9efd/ff46a/deploy-app-script.png 325w,\n/static/c8f5a4b38345fa0099dff321997e9efd/a6d36/deploy-app-script.png 650w,\n/static/c8f5a4b38345fa0099dff321997e9efd/e548f/deploy-app-script.png 975w,\n/static/c8f5a4b38345fa0099dff321997e9efd/3c492/deploy-app-script.png 1300w,\n/static/c8f5a4b38345fa0099dff321997e9efd/66632/deploy-app-script.png 1504w\"\n        sizes=\"(max-width: 650px) 100vw, 650px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span><br>\né»ä¸‹éƒ¨ç½²æŒ‰éˆ•å¾Œ<br>\nä»–æ‡‰è©²æœƒè·³å‡ºè¦åŒæ„æˆæ¬Šçš„èªè­‰<br>\nç¢ºèªä¹‹å¾Œ<br>\nä»–å°±æ˜¯éƒ¨ç½²æˆåŠŸï½<br>\næ¥è‘—å¯ä»¥æ‹¿åˆ° api url äº†<br>\nä¹Ÿå¯ä»¥åœ¨ç®¡ç†éƒ¨ç½²ä½œæ¥­æ‰¾åˆ°<br>\nç¶²é æ‡‰ç”¨ç¨‹å¼ ç¶²å€<br>\né€™å€‹ç¶²å€å°±æ˜¯æ‹¿ä¾†æ‰“ api ç”¨çš„<br>\nåœ¨ç¶²é è£¡ æ‰“ api</p>\n<pre class=\"grvsc-container abyss\" data-language=\"js\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">fetch</span><span class=\"mtk1\">(</span><span class=\"mtk11\">&quot;apiUrl&quot;</span><span class=\"mtk1\">, { method: </span><span class=\"mtk11\">&quot;POST&quot;</span><span class=\"mtk1\">, body: { user: </span><span class=\"mtk11\">&quot;name&quot;</span><span class=\"mtk1\">, message: </span><span class=\"mtk11\">&quot;.....&quot;</span><span class=\"mtk1\"> } });</span></span></span></code></pre>\n<p>æ‡‰è©²å°±èƒ½ä½¿ç”¨ google è¡¨å–®ç•¶ä½œè³‡æ–™åº«äº†ï½ï½<br>\né€™å€‹ç”¨æ³•æˆ‘è¦ºå¾—å¾ˆæ–¹ä¾¿<br>\nå¦‚æœæ˜¯ä¹‹å¾Œè¦æ•´ç†æˆè¡¨å–®<br>\næˆ–è€…è³‡æ–™æ‡‰ç”¨çš„æ™‚å€™<br>\nå°±å¯ä»¥ç›´æ¥æ‹¿ä¾†ç”¨</p>\n<p>ä»–é™¤äº† doPost ä»¥å¤–<br>\nä¹Ÿæœ‰ doGet çš„ function å¯ä»¥ç”¨<br>\nä¸é ä¹‹å‰ç”¨è®€å–çš„è³‡æ–™<br>\nå¥½åƒéƒ½æœƒè¦æ¯”è¼ƒä¹…ä¸€é»é»<br>\næ‰€ä»¥ç›®å‰ä¹Ÿæ²’æœ‰å¾ˆæ¨è–¦ä½¿ç”¨ï¼¸ï¼¤<br>\nè¦è®€å¯«çš„è©± æœç„¶é‚„æ˜¯ firebase æ›´å¥½ç”¨äº›<br>\nä¹‹å¾Œä¹Ÿæœƒåˆ†äº«ä¸€é»é» æˆ‘ä½¿ç”¨ firebase çš„ä½œæ³•ä¹‹é¡çš„</p>\n<p>ä»¥ä¸Šæ˜¯ä»Šå¤©çš„åˆ†äº« ğŸ‘‹</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .abyss { background-color: #000c18; }\n  .abyss .mtki { font-style: italic; }\n  .abyss .mtk15 { color: #9966B8; }\n  .abyss .mtk1 { color: #6688CC; }\n  .abyss .mtk6 { color: #DDBB88; }\n  .abyss .mtk3 { color: #384887; }\n  .abyss .mtk19 { color: #2277FF; }\n  .abyss .mtk7 { color: #225588; }\n  .abyss .mtk11 { color: #22AA44; }\n  .abyss .mtk4 { color: #F280D0; }\n  .abyss .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","frontmatter":{"date":"September 17, 2022","path":"/blog/from-hexo-to-gatsby-4","title":"Gatsbyç”¨èµ·ä¾†_Google sheet","type":"blog","image_cover":"https://images.unsplash.com/photo-1663124178632-488f399d5763?fit=crop&w=1000&q=80"}}},"pageContext":{"id":"855df0b2-364e-594a-89e4-0c4b091115bc","frontmatter__path":"/blog/from-hexo-to-gatsby-4","__params":{"frontmatter__path":"blog"}}},"staticQueryHashes":["3764592887"]}